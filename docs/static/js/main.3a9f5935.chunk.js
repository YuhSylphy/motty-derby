(this["webpackJsonpmotty-derby"]=this["webpackJsonpmotty-derby"]||[]).push([[0],{261:function(e,t,n){},448:function(e,t,n){},458:function(e,t,n){},460:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(242),r=n(494),s=n(0),i=n.n(s),o=n(14),j=n.n(o),u=(n(261),n(132)),l=n(9),b=n(130),f=n(496),d=n(462),h=n(463),O=n(72),m=n(162),x=(n(448),n(32)),p=function(){var e=Object(s.useRef)(null),t=Object(x.c)((function(e){return e.horseDefs.list})),n=Object(s.useMemo)((function(){return function(e){var t=new Map,n=[];return e.forEach((function(e){t.set(e.name,{label:e.name,class:"owned ".concat(e.sex)}),e.motherName&&(t.has(e.motherName)||t.set(e.motherName,{label:e.motherName,class:"anothers female"}),n.push([{v:e.motherName,w:e.name},{class:"mother"}])),e.fatherName&&(t.has(e.fatherName)||t.set(e.fatherName,{label:e.fatherName,class:"anothers male"}),n.push([{v:e.fatherName,w:e.name},{class:"father"}]))})),{nodes:Array.from(t.entries()),edges:n}}(t)}),[t]);return Object(s.useEffect)((function(){var t=O.select(e.current);if(t.selectAll("g").remove(),0!==n.nodes.length||0!==n.edges.length){var a=(new m.graphlib.Graph).setGraph({rankdir:"LR"}).setDefaultEdgeLabel((function(){return{}}));n.nodes.forEach((function(e){a.setNode(e[0],e[1])})),a.nodes().forEach((function(e){var t=a.node(e);t.rx=t.ry=5})),n.edges.forEach((function(e){a.setEdge(e[0],e[1])}));var c=new m.render,r=t.append("g"),s=O.zoom().on("zoom",(function(){r.attr("transform",O.event.transform)}));t.call(s),c(O.select("svg g"),a);var i=(Number(t.attr("width"))-(a.graph().width||0))/2;r.attr("transform","translate(".concat(Number.isNaN(i)?0:i,", 20)"))}}),[e,n]),Object(a.jsx)(s.Fragment,{children:Object(a.jsx)("svg",{className:"d3-component mottv-derby-family",width:"100%",height:"70vh",ref:e})})},g=function(){return Object(a.jsxs)(f.a,{children:[Object(a.jsx)(d.a,{variant:"h4",children:"\u7cfb\u56f3"}),Object(a.jsx)(h.a,{children:Object(a.jsx)(p,{})})]})},v=function(){return Object(a.jsx)("h2",{children:"404 NOT FOUND"})},w=n(502),y=n(490),N=n(491),k=n(498),E=n(497),M=n(50),D=n(493),F=n(492),I=n(68),T=Object(I.b)({name:"horseDefs",initialState:{list:[]},reducers:{init:function(){},set:function(e,t){e.list=t.payload.list}}}),S=T.actions,C=T.reducer,A=n(164),z=n.n(A),L=n(237),G=n(500),B=n(245),J=n(244),R=n(84),V=n(86),W=Object(I.b)({name:"indicator",initialState:{awaits:{}},reducers:{set:function(e,t){e.awaits=t.payload},open:function(e,t){var n=t.payload;e.awaits=Object(V.a)(Object(V.a)({},e.awaits),{},Object(R.a)({},n,1+(n in e.awaits?e.awaits[n]:0)))},close:function(e,t){var n=t.payload;n in e.awaits||console.warn("there isnt key [".concat(n,"] in "));var a=e.awaits,c=a[n],r=Object(B.a)(a,[n].map(J.a));e.awaits=Object(V.a)(Object(V.a)({},r),c>1?Object(R.a)({},n,c-1):{})}}}),_=W.actions,K=W.reducer,U=n(504),Y=n(124),$=n(486),q=n(246),H=_.open,P=_.close,Q=n(487),X=n(499),Z=n(488),ee=Object(Q.a)((function(e){return{backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}})),te=function(){var e=ee(),t=Object(x.c)((function(e){return e.indicator})).awaits,n=Object(s.useMemo)((function(){return Object.values(t).some((function(e){return e>0}))}),[t]);return Object(a.jsx)(X.a,{className:e.backdrop,open:n,children:Object(a.jsx)(Z.a,{color:"inherit"})})},ne=Object(G.a)((function(e){return e.ofType(S.init.type).pipe((t="horse-defs/fetch",n=Object(L.a)(z.a.mark((function e(){return z.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=S,e.next=3,fetch("".concat("/motty-derby","/assets/horse-defs.json")).then((function(e){return e.json()}));case 3:return e.t1=e.sent,e.t2={list:e.t1},e.abrupt("return",e.t0.set.call(e.t0,e.t2));case 6:case"end":return e.stop()}}),e)}))),function(e){return e.pipe(Object(q.a)((function(e){return Object(U.a)(Object(Y.a)(H(t)),Object($.a)((function(){return n(e)})),Object(Y.a)(P(t)))})))}));var t,n})),ae=n(243),ce=n(501),re=n(506),se=n(489),ie=n(239),oe=n.n(ie),je=n(240),ue=n.n(je),le=n(241),be=n.n(le),fe=n(165),de=n(166),he=Object(Q.a)((function(e){return Object(ce.a)({root:{"& .name":{marginLeft:e.spacing(.5)},"& .father":{marginLeft:e.spacing(1)},"& .male":{color:"#2196f3"},"& .female":{color:"#f44336"}}})})),Oe=function e(t){return function(n){return Object(a.jsx)(re.a,{className:n.className,nodeId:n.id,label:n.label,onIconClick:t(n),children:n.children.map(e(t))},n.id)}},me=function(){var e=he(),t=Object(x.b)(),n=Object(s.useState)([]),c=Object(u.a)(n,2),r=c[0],i=c[1],o=Object(x.c)((function(e){return e.horseDefs.list})),j=Object(s.useMemo)((function(){return o.length>0?function(e){return function(t){return function(n){try{return e(H(t)),n()}finally{e(P(t))}}}}(t)("mare-line/init")((function(){return function(e){var t=new Set,n=new Map,c=function(e){return n.has(e)?n.get(e):function(){var t={id:e,label:Object(a.jsx)(s.Fragment,{}),children:[]};return n.set(e,t),t}()};return e.forEach((function(e){var n=c(e.name);n.className=[e.sex].join(" "),n.label=Object(a.jsxs)(s.Fragment,{children:[function(){switch(e.sex){case"male":return Object(a.jsx)(fe.a,{icon:de.a});case"female":return Object(a.jsx)(fe.a,{icon:de.b});case"unknown":return null;default:e.sex}}(),Object(a.jsx)("span",{className:"name",children:e.name}),e.fatherName?Object(a.jsxs)("span",{className:"father male",children:["(",e.fatherName,")"]}):null]}),e.motherName?c(e.motherName).children.push(n):t.add(n)})),{nodes:Array.from(t.values()),ids:Array.from(n.keys())}}(o)})):{nodes:[],ids:[]}}),[t,o]),l=j.nodes,b=j.ids;Object(s.useEffect)((function(){i(b)}),[b]);var f=Object(s.useMemo)((function(){return function(e){return function(t){i(r.includes(e.id)?r.filter((function(t){return t!==e.id})):[].concat(Object(ae.a)(r),[e.id]))}}}),[r,i]);return Object(a.jsx)(s.Fragment,{children:Object(a.jsx)(se.a,{className:e.root,expanded:r,defaultCollapseIcon:Object(a.jsx)(oe.a,{}),defaultExpandIcon:Object(a.jsx)(ue.a,{}),defaultEndIcon:Object(a.jsx)(be.a,{}),children:l.map(Oe(f))})})},xe=function(){return Object(a.jsxs)(s.Fragment,{children:[Object(a.jsx)(d.a,{variant:"h4",children:"\u725d\u7cfb\u56f3"}),Object(a.jsx)(h.a,{children:Object(a.jsx)(me,{})})]})},pe=(n(458),function(e){return Object(a.jsx)(d.a,{children:Object(a.jsx)(b.b,{to:e.path,children:e.label})})}),ge=function(e){var t=e.toggleMenu;return Object(a.jsx)(w.a,{onClick:t,onKeyDown:t,children:[{label:"\u725d\u7cfb\u56f3",path:"/mare-line"},{label:"\u5bb6\u7cfb\u56f3(\u65e7)",path:"/family"}].map(pe)})},ve=function(){var e=Object(s.useState)(!1),t=Object(u.a)(e,2),n=t[0],c=t[1],r=Object(s.useMemo)((function(){return function(){c(!n)}}),[n,c]);return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(y.a,{position:"static",children:Object(a.jsxs)(N.a,{children:[Object(a.jsx)(k.a,{edge:"start",color:"inherit","aria-label":"menu",onClick:r,children:Object(a.jsx)(F.a,{})}),Object(a.jsx)(d.a,{variant:"h6",children:"MOTTV Derby"})]})}),Object(a.jsx)(E.a,{open:n,onClose:r,children:Object(a.jsx)(ge,{toggleMenu:r})})]})},we=function(){var e=Object(M.a)();return Object(a.jsx)(f.a,{display:"flex",justifyContent:"flex-end",margin:e.spacing(.2),children:Object(a.jsx)(D.a,{href:"https://www.youtube.com/user/MOTTYGAMES/",target:"__blank",children:"MOTTV"})})},ye=function(){var e=Object(M.a)(),t=Object(x.b)();return Object(s.useEffect)((function(){t(S.init())}),[t]),Object(a.jsx)(b.a,{basename:"/motty-derby",children:Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(ve,{}),Object(a.jsx)(f.a,{margin:e.spacing(.5),children:Object(a.jsxs)(l.d,{children:[Object(a.jsx)(l.b,{path:"/family",children:Object(a.jsx)(g,{})}),Object(a.jsx)(l.b,{path:"/mare-line",children:Object(a.jsx)(xe,{})}),Object(a.jsx)(l.b,{exact:!0,path:"/",children:Object(a.jsx)(l.a,{to:"/mare-line"})}),Object(a.jsx)(l.b,{children:Object(a.jsx)(v,{})})]})}),Object(a.jsx)(we,{}),Object(a.jsx)(te,{})]})})},Ne=n(495),ke=Object(Ne.a)({dependencies:{}}),Ee=Object(I.a)({reducer:{horseDefs:C,indicator:K},middleware:function(e){return e({thunk:!1}).concat([ke])}});ke.run(Object(G.a)(ne));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Me=Object(c.a)({});j.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(r.a,{theme:Me,children:Object(a.jsx)(x.a,{store:Ee,children:Object(a.jsx)(ye,{})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[460,1,2]]]);
//# sourceMappingURL=main.3a9f5935.chunk.js.map